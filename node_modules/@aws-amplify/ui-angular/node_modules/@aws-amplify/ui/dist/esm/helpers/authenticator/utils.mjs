import{__awaiter as t,__generator as n,__assign as e}from"tslib";import{Hub as r}from"aws-amplify";import{appendToCognitoUserAgent as a}from"@aws-amplify/auth";import{waitFor as o}from"xstate/lib/waitFor.js";import{ALLOWED_SPECIAL_CHARACTERS as u}from"./constants.mjs";import{getActorState as c}from"./actor.mjs";var i=function(t){var n=t.packageName,e=t.version;a("".concat(n,"/").concat(e))},s=function(t){for(var n=t.trim().split(""),e=0;e<n.length;e++)e>0&&e<n.length-1&&(n[e]="*");return n.join("")},f=function(t){if(t.length<4)return t;for(var n=t.split(""),e=0;e<n.length-4;e++)n[e]="*";return n.join("")},l=function(e){return t(void 0,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o(e,(function(t){return c(t).matches("autoSignIn")}))];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},h=function(e,r){return t(void 0,void 0,void 0,(function(){var t,a,o;return n(this,(function(n){switch(n.label){case 0:switch(t=r.send,a=r.getSnapshot(),e.payload.event){case"tokenRefresh":return[3,1];case"autoSignIn":return[3,2];case"autoSignIn_failure":return[3,5];case"signOut":case"tokenRefresh_failure":return[3,7]}return[3,8];case 1:return a.matches("authenticated.idle")&&t("TOKEN_REFRESH"),[3,9];case 2:return a.matches("authenticated")?[3,4]:[4,l(r)];case 3:n.sent(),(null==(o=c(r.getSnapshot()))?void 0:o.matches("autoSignIn"))&&t({type:"AUTO_SIGN_IN",data:e.payload.data}),n.label=4;case 4:return[3,9];case 5:return[4,l(r)];case 6:return n.sent(),(null==(o=c(r.getSnapshot()))?void 0:o.matches("autoSignIn"))&&t({type:"AUTO_SIGN_IN_FAILURE",data:e.payload.data}),[3,9];case 7:return a.matches("authenticated.idle")&&t("SIGN_OUT"),[3,9];case 8:return[3,9];case 9:return[2]}}))}))},d=function(t,n){return void 0===n&&(n=h),r.listen("auth",function(t,n){return function(e){n(e,t)}}(t,n),"authenticator-hub-handler")},m=function(t){return u.some((function(n){return t.includes(n)}))},p=function(t,n,e){return encodeURI("otpauth://totp/".concat(t,":").concat(n,"?secret=").concat(e,"&issuer=").concat(t))};function v(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return Object.entries(t).reduce((function(t,r){var a,o=r[0],u=r[1];return e(e({},t),((a={})[o]=n.includes(o)?u:null==u?void 0:u.trim(),a))}),{})}export{s as censorAllButFirstAndLast,f as censorPhoneNumber,i as configureComponent,h as defaultAuthHubHandler,p as getTotpCodeURL,m as hasSpecialChars,d as listenToAuthHub,v as trimValues};
